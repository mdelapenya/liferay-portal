import com.liferay.gradle.plugins.patcher.PatchTask

apply plugin: "com.liferay.patcher"

task deployJar(type: Copy)
task patch(type: PatchTask)

sourceCompatibility = "1.6"
targetCompatibility = "1.6"

dependencies {
	compile group: "org.hibernate", name: "hibernate-core", optional, version: "3.6.10.Final"
}

deploy {
	finalizedBy deployJar
}

deployJar {
	ext {
		autoClean = false
	}

	from jar
	into "../../../lib/portal"

	rename {
		"hibernate-core.jar"
	}
}

patch {
	ext {
		autoClean = false
	}

	fileNames "org/hibernate/cache/UpdateTimestampsCache.java"
	fileNames "org/hibernate/intercept/FieldInterceptionHelper.java"
	fileNames "org/hibernate/cfg/Environment.java"
	fileNames "org/hibernate/engine/StatefulPersistenceContext.java"
	fileNames "org/hibernate/engine/query/HQLQueryPlan.java"
	fileNames "org/hibernate/engine/query/QueryPlanCache.java"
	fileNames "org/hibernate/hql/QueryTranslatorFactory.java"
	fileNames "org/hibernate/hql/ast/QueryTranslatorImpl.java"
	fileNames "org/hibernate/hql/classic/QueryTranslatorImpl.java"
	fileNames "org/hibernate/impl/AbstractSessionImpl.java"
	fileNames "org/hibernate/impl/SessionFactoryImpl.java"
	fileNames "org/hibernate/internal/util/collections/BoundedConcurrentHashMap.java"
	fileNames "org/hibernate/internal/util/collections/ConcurrentReferenceHashMap.java"
	originalLibModuleName = "hibernate-core"
}